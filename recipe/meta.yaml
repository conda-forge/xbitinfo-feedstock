{% set name = "xbitinfo-outputs" %}
{% set version = "0.0.4.dev2" %}
{% set commit = "6fd035bd2f0129b6169432e43420e7ed511b91d6" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://github.com/observingClouds/xbitinfo/archive/{{ commit }}.tar.gz
  sha256: 9f758a0e6a3b7ec1b5efc887a40e76c2163ae0e086fdbb453a04fb11fa57741c

build:
  number: 0
  noarch: python

test:
  requires:
    - pooch
    - netcdf4

outputs:
  - name: xbitinfo-python-base
    build:
      noarch: python
    script: build_base.sh
    requirements:
      host:
        - python >=3.9
        - pip
        - setuptools >=30.3.0
        - setuptools-scm
      run:
        - python >=3.9
        - dask
        - numcodecs >=0.10.0
        - tqdm
        - xarray
    test:
      imports:
        - xbitinfo
      commands:
        - pip check
      requires:
        - pip

  - name: xbitinfo-python
    build:
      noarch: python
    script: build_base.sh
    requirements:
      host:
        - python >=3.9
        - pip
        - setuptools >=30.3.0
        - setuptools-scm
      run:
        - python >=3.9
        - xarray
        - tqdm
        - numcodecs >=0.10.0
        # extras::viz
        - matplotlib-base
        - cmcrameri
        # extras::prefect
        - prefect >=1.0.0,<2.0
        # io
        - netcdf4
        - zarr
    test:
      imports:
        - xbitinfo
      commands:
        - pip check
      requires:
        - pip

  - name: xbitinfo
    build:
      noarch: generic
    requirements:
      run:
        - {{ pin_subpackage('xbitinfo-python', max_pin="x.x.x") }}
        - pyjulia >=0.5.7
        - julia >=1.6.0,<1.8.0

about:
  home: https://github.com/observingClouds/xbitinfo
  summary: Retrieve information content and compress accordingly.
  license: MIT
  license_file:
    - LICENSE

extra:
  recipe-maintainers:
    - rsignell-usgs
    - observingClouds
    - ocefpaf
